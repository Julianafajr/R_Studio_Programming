---
title: "Assigment 1"
author: "The Business of Health"
date: "2025-08-26"
output: word_document
---


```{r}
#Load Package
library(tidyverse)
library(patchwork)
```


```{r}
# Load Data
df <- readr::read_csv("C:/Users/Acer/Downloads/A1_data.csv") %>%
  select(-matches("^Unnamed"))

df <- df %>% mutate(region = as.factor(region))
head(df)
```


```{r}
# Helper function for the scatter plots
mk_scatter <- function(data, xvar, xlab) {
  ggplot(data, aes(x = .data[[xvar]], y = happiness_score, color = region)) +
    geom_point(alpha = 0.6, size = 1.8, na.rm = TRUE) +
    geom_smooth(method = "lm", se = FALSE, linewidth = 0.9, na.rm = TRUE) +
    geom_smooth(method = "loess", se = FALSE, linetype = "22", linewidth = 0.9,
                span = 0.9, na.rm = TRUE) +
    labs(
      x = xlab,
      y = "happiness score",
      title = paste("happiness score vs", xlab),
      subtitle = "Linear fit (solid) and LOESS (dashed)"
    ) +
    guides(color = guide_legend(title = "region")) +
    theme_minimal(base_size = 12) +
    theme(
      legend.position = "right",
      plot.title = element_text(face = "bold", size = 14),
      panel.grid.minor = element_blank()
    )
}

# ====== Plot 1–3 ======
p1 <- mk_scatter(df, "social_support", "social support")
p2 <- mk_scatter(df, "gdp_per_capita", "GDP per capita")
p3 <- mk_scatter(df, "healthcare_spending", "healthcare spending")

#Show the plot
final_plot <- p1 / p2 / p3  
final_plot


ggsave("C:/Users/Acer/Downloads/scatter_one_column_with_legends.png", final_plot, width = 8, height = 18, dpi = 300)
```
```{r}
# Australia vs Indonesia — standardized (z-score) time trends
df_sub <- df %>%
  filter(country %in% c("Australia", "Indonesia"))

indicators <- c("happiness_score", "gdp_per_capita",
                "social_support", "healthcare_spending")

df_long <- df_sub %>%
  pivot_longer(cols = all_of(indicators), names_to = "indicator", values_to = "value") %>%
  group_by(indicator) %>%
  mutate(z_value = scale(value)[,1]) %>%
  ungroup()

label_map <- c(
  happiness_score = "Happiness score",
  gdp_per_capita = "GDP per capita",
  social_support = "Social support",
  healthcare_spending = "Healthcare spending"
)
df_long$indicator <- factor(df_long$indicator, levels = indicators,
                            labels = label_map[indicators])

# ====== Plot ======
plot <- ggplot(df_long, aes(x = year, y = z_value, color = country)) +
  geom_line(linewidth = 1) +
  geom_point(size = 2) +
  facet_wrap(~indicator, scales = "free_y", ncol = 2) +
  labs(
    title = "Australia vs Indonesia — standardised trends",
    subtitle = "Z-scores within each indicator",
    x = "Year", y = "Standardised Value (z-score)"
  ) +
  theme_minimal(base_size = 13) +
  theme(
    legend.position = "right",
    plot.title = element_text(face = "bold", size = 14)
  )

plot

ggsave("C:/Users/Acer/Downloads/Australia_vs_Indonesia.png", plot, width = 10, height = 7, dpi = 300)
```


